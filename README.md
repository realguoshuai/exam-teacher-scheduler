# 监考老师排班系统 - 使用文档

## 一、系统简介

监考老师排班系统是一个智能化的考试监考人员自动分配系统，支持：
- 自动根据考试科目配置监考人数
- 公平分配监考任务给老师
- 导出排班结果到Excel
- 统计分析排班数据

---

## 二、排班规则详解

### 2.1 监考人数规则（每考场）

| 科目类型 | 每考场监考老师数 | 说明 |
|---------|-----------------|------|
| **语文** | **2位老师** | 主科，需要2名老师共同监考 |
| **数学** | **2位老师** | 主科，需要2名老师共同监考 |
| **英语** | **2位老师** | 主科，需要2名老师共同监考 |
| **政治** | 1位老师 | 副科 |
| **历史** | 1位老师 | 副科 |
| **地理** | 1位老师 | 副科 |
| **生物** | 1位老师 | 副科 |
| **化学** | 1位老师 | 副科 |
| **物理** | 1位老师 | 副科 |
| **其他副科** | 1位老师 | 可根据需要调整 |

### 2.2 考场数规则（每考试）

- 每个考试科目可以设置不同的考场数
- 默认为 6 个考场
- 可根据实际考试人数、学校资源调整

**计算公式**：
```
某考试所需监考老师总数 = 考场数 × 每考场监考老师数

例如：
- 数学考试：6个考场 × 2位老师 = 需要12位老师
- 物理考试：6个考场 × 1位老师 = 需要6位老师
```

### 2.3 排班分配原则

1. **时间公平**：同一时间段内，每位老师只能在一个考场监考
2. **次数公平**：监考次数少的老师优先分配
3. **随机性**：在监考次数相同的情况下随机分配
4. **完整覆盖**：所有考场必须分配到足够的老师，否则显示警告

---

## 三、操作指南

### 3.1 启动系统

#### 方式一：双击启动（推荐Windows用户）
1. 双击 `启动程序.bat`
2. 浏览器会自动打开 http://localhost:5000
3. 按照页面提示操作

#### 方式二：命令行启动
```bash
# 开发环境
python app.py

# 或使用打包后的exe
监考老师排班系统.exe
```

### 3.2 添加监考老师

#### 方式一：手动添加
1. 点击"👥 监考老师"标签
2. 点击"➕ 手动添加"按钮
3. 填写以下信息：
   - **工号**：老师的唯一标识（必填，不能重复）
   - **姓名**：老师的姓名
   - **职称**：如副教授、讲师等
   - **联系方式**：电话号码
   - **所属部门**：如计算机学院、数学学院等

#### 方式二：Excel批量导入
1. 准备Excel文件，包含以下列：
   - 工号
   - 姓名
   - 职称
   - 联系方式
   - 所属部门

2. Excel模板示例：
```
| 工号 | 姓名   | 职称   | 联系方式      | 所属部门     |
|------|--------|--------|---------------|--------------|
| T001 | 张老师 | 副教授 | 13800000001  | 计算机学院   |
| T002 | 李老师 | 讲师   | 13800000002  | 数学学院     |
```

3. 在监考老师页面点击"📤 导入Excel"按钮
4. 选择文件上传

#### 方式三：清空并重新导入
1. 点击"🗑️ 清空"按钮删除所有老师
2. 然后重新导入

### 3.3 添加考试信息

#### 方式一：手动添加单个考试
1. 点击"📝 考试信息"标签
2. 点击"➕ 手动添加"按钮
3. 填写以下信息：

| 字段 | 说明 | 示例 | 备注 |
|------|------|------|------|
| 考试编号 | 考试的唯一标识 | E001 | 必填，不能重复 |
| 考试名称 | 考试的全称 | 期末考试-高等数学 | 必填 |
| 科目 | 考试科目 | 数学 | 必填，决定监考人数 |
| 日期 | 考试日期 | 2024-06-15 | YYYY-MM-DD格式 |
| 时间段 | 考试时间 | 08:30-10:30 | 格式：HH:MM-HH:MM |
| 考场 | 考场编号（可选） | A101 | 可留空 |
| 需要监考人数 | **每考场老师数** | 2 | 语数外填2，其他填1 |
| 考场数 | **该考试的考场数** | 6 | 默认6，根据实际调整 |

4. 点击"添加"按钮

**重要提示**：
- **需要监考人数**字段决定了每个考场分配几位老师
  - 语文、数学、英语：填 **2**
  - 政治、历史、地理、生物、化学、物理：填 **1**

- **考场数**字段决定了该考试需要安排多少个考场
  - 默认值为 **6**
  - 可根据实际考试人数调整

例如：
```
考试: 数学期末考试
- 日期: 2024-06-15
- 时间段: 08:30-10:30
- 需要监考人数: 2 (每个考场2位老师)
- 考场数: 6 (需要6个考场)
- 总需老师: 6 × 2 = 12 位老师
```

```
考试: 物理期末考试
- 日期: 2024-06-16
- 时间段: 14:00-16:00
- 需要监考人数: 1 (每个考场1位老师)
- 考场数: 6 (需要6个考场)
- 总需老师: 6 × 1 = 6 位老师
```

#### 方式二：Excel批量导入
1. 准备Excel文件，包含以下列：
   - 考试编号
   - 考试名称
   - 科目
   - 日期
   - 时间段
   - 考场（可选）
   - 需要监考人数
   - 考场数

2. Excel模板示例：
```
| 考试编号 | 考试名称         | 科目 | 日期       | 时间段     | 考场 | 需要监考人数 | 考场数 |
|---------|------------------|------|------------|------------|------|-------------|--------|
| E001    | 期末考试-高等数学 | 数学 | 2024-06-15 | 08:30-10:30| A101 | 2           | 6      |
| E002    | 期末考试-大学物理 | 物理 | 2024-06-16 | 14:00-16:00| C301 | 1           | 6      |
```

3. 在考试信息页面点击"📤 导入Excel"按钮
4. 选择文件上传

### 3.4 执行自动排班

1. 点击"📅 排班管理"标签
2. 点击"🚀 自动排班"按钮
3. 系统会自动执行排班，并显示排班结果

**排班完成后你会看到**：
- 按时间分组显示所有考场分配情况
- 每个考场显示监考老师的姓名
- 统计信息：总考试数、已排班数、未排班数

### 3.5 查看排班结果

在"📅 排班管理"页面，排班结果会以分组卡片形式展示：

```
2024-06-15 - 08:30-10:30
├─ 📚 数学
│  ├─ 📍 数学考场1: 👨‍🏫 张三、李四
│  ├─ 📍 数学考场2: 👨‍🏫 王五、赵六
│  └─ ...

2024-06-15 - 14:00-16:00
├─ 📚 英语
│  ├─ 📍 英语考场1: 👨‍🏫 孙七、周八
│  └─ ...
```

### 3.6 导出排班结果

#### 导出排班表（Excel）
1. 在"📅 排班管理"页面
2. 点击"📥 导出Excel"按钮
3. 下载的Excel包含：日期、时间段、考场、考试名称、科目、监考老师等信息

#### 导出统计分析（带图表）
1. 点击"📊 统计分析"标签
2. 点击"📥 导出详细数据"按钮
3. 下载的Excel包含3个Sheet：
   - **Sheet1 - 老师监考统计图**：柱状图展示每位老师监考次数
   - **Sheet2 - 每日排班统计图**：柱状图展示每天的排班场次
   - **Sheet3 - 总体统计图**：饼图展示排班完成情况

---

## 四、系统配置

在"⚙️ 系统配置"页面，可以配置以下参数：

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| 每个老师每天最多监考次数 | 限制老师每天监考的场次 | 3 |
| 连续监考最多场次 | 限制老师连续监考的场次 | 2 |
| 时间段1 | 可选的时间段1 | 08:30-10:30 |
| 时间段2 | 可选的时间段2 | 10:45-12:45 |
| 时间段3 | 可选的时间段3 | 14:00-16:00 |
| 时间段4 | 可选的时间段4 | 16:15-18:15 |

**注意**：这些配置项目前暂未在排班逻辑中使用，可作为参考或预留功能。

---

## 五、常见问题

### Q1: 为什么有的考场显示"没有可用老师"？

**A**: 这说明当前时间段可用的老师数量不足。解决方法：
1. 检查该时间段的考试是否安排过多
2. 增加监考老师数量
3. 调整考试的时间安排，避免集中在同一时间段
4. 减少某些考试的考场数或每考场老师数

### Q2: 如何修改某个考试的考场数？

**A**:
1. 进入"📝 考试信息"页面
2. 找到要修改的考试
3. 点击"修改"按钮
4. 修改"考场数"字段
5. 保存后重新执行排班

### Q3: 排班规则可以自定义吗？

**A**: 可以。在添加或编辑考试时，可以自由设置：
- **需要监考人数**：决定每个考场分配几位老师
- **考场数**：决定该考试需要安排多少个考场

不同科目可以有不同配置，例如：
- 数学：每考场2位老师，8个考场
- 物理：每考场1位老师，4个考场

### Q4: 导出的Excel文件在哪里？

**A**:
- 导出的文件会自动下载到浏览器的默认下载目录
- 文件名格式：
  - 排班表：`schedule_20240615_143022.xlsx`
  - 统计分析：`statistics_20240615_143022.xlsx`

### Q5: 如何重新排班？

**A**:
1. 在"📅 排班管理"页面，点击"🗑️ 重置数据"
2. 或修改考试/老师数据后，直接点击"🚀 自动排班"
3. 系统会根据最新数据重新执行排班

### Q6: 同一时间段内有多个科目考试，如何处理？

**A**: 系统会自动处理：
- 同一时间段的多个科目考试会被一起处理
- 老师在同一时间段只能被分配到一个考场
- 系统会自动分配足够的老师满足所有考试需求

---

## 六、技术支持

### 数据文件位置

所有数据保存在项目的 `data` 目录下：
- `data/teachers.xlsx` - 监考老师数据
- `data/exams.xlsx` - 考试信息
- `data/config.xlsx` - 系统配置
- `data/schedule.xlsx` - 排班结果

### 备份数据

建议定期备份 `data` 目录，以防数据丢失。

### 日志输出

系统运行时会输出详细的日志信息，包括：
- 加载的老师数量
- 加载的考试数量
- 每个时间段的排班情况
- 总共生成的排班记录数

---

## 七、快速上手示例

### 示例场景：高二期末考试

**第一步：添加老师**
添加10位监考老师：
- T001-T010，分别来自不同学院

**第二步：添加考试**
```
| 考试编号 | 考试名称         | 科目 | 日期       | 时间段     | 需要监考人数 | 考场数 |
|---------|------------------|------|------------|------------|-------------|--------|
| E001    | 高二期末考试-语文 | 语文 | 2024-06-15 | 08:30-10:30| 2           | 6      |
| E002    | 高二期末考试-数学 | 数学 | 2024-06-15 | 14:00-16:00| 2           | 6      |
| E003    | 高二期末考试-英语 | 英语 | 2024-06-16 | 08:30-10:30| 2           | 6      |
| E004    | 高二期末考试-物理 | 物理 | 2024-06-16 | 14:00-16:00| 1           | 6      |
| E005    | 高二期末考试-化学 | 化学 | 2024-06-17 | 08:30-10:30| 1           | 6      |
```

**第三步：执行排班**
点击"🚀 自动排班"，系统自动分配：
- 语文：6考场×2老师=12位老师
- 数学：6考场×2老师=12位老师
- 英语：6考场×2老师=12位老师
- 物理：6考场×1老师=6位老师
- 化学：6考场×1老师=6位老师

**第四步：导出结果**
点击"📥 导出Excel"下载排班表，打印分发。

---

## 八、版本信息

- **版本**: 1.0
- **更新日期**: 2026年
- **技术栈**: Flask + Python + Excel + ChartJS

---

## 九、联系支持

如有问题或建议，请联系系统管理员。
